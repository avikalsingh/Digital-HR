{% load static %}

<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    
    <!-- Modern HR CSS -->
    <link href="{% static 'css/modern-hr.css' %}" rel="stylesheet">

    <!-- reCAPTCHA Script -->
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>

    <title>Admin: {% block title %}Dashboard{% endblock title %}</title>
  </head>
  
  <body>
    <!-- Navbar -->
    <h1 class="navbar navbar-expand-lg navbar-light bg-light mb-0 px-4">
      <img src="{% static 'images/logo4.png' %}" height="40" width="40" alt="Logo">
      ElectroTech Admin
    </h1>
    
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
      <div class="container-fluid">
        <a class="navbar-brand" href="/admin_home"></a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link active" href="/admin_home">ğŸ“Š Dashboard</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/emp_reg">ğŸ‘¥ Employees</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/jobseeker">ğŸ¯ Job Seekers</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/contact_view">ğŸ’¬ Messages</a>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                âš™ï¸ Settings
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li><a class="dropdown-item" href="/emp_manage">ğŸ‘¤ Manage Employees</a></li>
                <li><a class="dropdown-item" href="/city">ğŸ™ï¸ Add City</a></li>
                <li><a class="dropdown-item" href="/qualification">ğŸ“ Add Qualification</a></li>
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item" href="/change_password">ğŸ” Change Password</a></li>
              </ul>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/generate_mail">ğŸ“§ Send Emails</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#" onclick="confirmLogout(event)">ğŸšª Logout</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Messages -->
    {% if messages %}
      {% for message in messages %}
        <div class="alert alert-{{ message.tags }} alert-dismissible fade show mb-0" role="alert">
          <strong>{{ message }}</strong>
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
      {% endfor %}
    {% endif %}

    <!-- Main Content -->
    {% block body %}
    
    <div style="background: linear-gradient(135deg, #082f49 0%, #0c4a6e 40%, #0f766e 100%); min-height: calc(100vh - 200px); padding: 2rem 1rem; display: flex; align-items: center; justify-content: center;">
      <div style="max-width: 1200px; width: 100%;">
        
        <!-- Welcome Section -->
        <div class="card mb-4" style="background: rgba(255, 255, 255, 0.95); border: none; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.2); text-align: center;">
          <div class="card-body py-4">
            <h1 style="font-size: 2rem; font-weight: 700; color: var(--primary-color); margin: 0;">Welcome to Admin Dashboard ğŸ‘‹</h1>
            <p style="color: var(--text-muted); margin-top: 0.5rem; margin-bottom: 0; font-size: 1rem;">Manage your HR operations efficiently and effectively</p>
          </div>
        </div>

        <!-- Dynamic Stats Section -->
        <div class="row g-3 mb-4">
          <!-- Total Employees -->
          <div class="col-md-6 col-lg-3">
            <div class="card stat-card primary text-center h-100" style="background: white; border: none; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); margin-left: auto; margin-right: auto;">
              <div class="card-body py-4">
                <div class="stat-icon bg-primary mx-auto mb-3">ğŸ‘¥</div>
                <div class="stat-number" style="color: var(--primary-color); font-size: 1.8rem;">{{ total_employees }}</div>
                <div class="stat-label" style="font-size: 0.9rem;">Total Employees</div>
              </div>
            </div>
          </div>

          <!-- Active Job Seekers -->
          <div class="col-md-6 col-lg-3">
            <div class="card stat-card success text-center h-100" style="background: white; border: none; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); margin-left: auto; margin-right: auto;">
              <div class="card-body py-4">
                <div class="stat-icon bg-success mx-auto mb-3">ğŸ¯</div>
                <div class="stat-number" style="color: var(--success-color); font-size: 1.8rem;">{{ total_jobseekers }}</div>
                <div class="stat-label" style="font-size: 0.9rem;">Active Job Seekers</div>
              </div>
            </div>
          </div>

          <!-- Total Messages -->
          <div class="col-md-6 col-lg-3">
            <div class="card stat-card warning text-center h-100" style="background: white; border: none; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); margin-left: auto; margin-right: auto;">
              <div class="card-body py-4">
                <div class="stat-icon bg-warning mx-auto mb-3">ğŸ’¬</div>
                <div class="stat-number" style="color: var(--warning-color); font-size: 1.8rem;">{{ total_messages }}</div>
                <div class="stat-label" style="font-size: 0.9rem;">Total Messages</div>
              </div>
            </div>
          </div>

          <!-- Recent Messages (Last 24 hours) -->
          <div class="col-md-6 col-lg-3">
            <div class="card stat-card info text-center h-100" style="background: white; border: none; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); margin-left: auto; margin-right: auto;">
              <div class="card-body py-4">
                <div class="stat-icon bg-info mx-auto mb-3;">ğŸ“©</div>
                <div class="stat-number" style="color: var(--info-color); font-size: 1.8rem;">{{ recent_messages }}</div>
                <div class="stat-label" style="font-size: 0.9rem;">Recent Messages (24h)</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Quick Actions Section Title (Centered) -->
        <div class="mb-4" style="text-align: center;">
          <h3 style="font-weight: 700; margin-bottom: 1.5rem; color: white; font-size: 1.3rem;">âš¡ Quick Actions</h3>
        </div>

        <!-- Quick Actions Grid (3 Columns - Centered) -->
        <div class="row g-3 mb-4">
          <!-- Employee Management -->
          <div class="col-md-6 col-lg-4">
            <div class="card h-100 border-0 shadow-sm" style="background: white; border-radius: 15px; transition: transform 0.3s, box-shadow 0.3s; cursor: pointer; text-align: center; margin-left: auto; margin-right: auto;">
              <div class="card-body p-4">
                <div style="font-size: 2.5rem; margin-bottom: 1rem;">ğŸ‘¤</div>
                <h5 style="font-weight: 600; color: var(--primary-color); margin-bottom: 0.5rem;">Manage Employees</h5>
                <p style="color: var(--text-muted); margin-bottom: 1rem; font-size: 0.9rem;">View, edit, and manage employee records</p>
                <a href="/emp_manage" class="btn btn-sm btn-primary">Go to Employees â†’</a>
              </div>
            </div>
          </div>

          <!-- Job Seekers -->
          <div class="col-md-6 col-lg-4">
            <div class="card h-100 border-0 shadow-sm" style="background: white; border-radius: 15px; transition: transform 0.3s, box-shadow 0.3s; cursor: pointer; text-align: center; margin-left: auto; margin-right: auto;">
              <div class="card-body p-4">
                <div style="font-size: 2.5rem; margin-bottom: 1rem;">ğŸ¯</div>
                <h5 style="font-weight: 600; color: var(--success-color); margin-bottom: 0.5rem;">Job Seekers</h5>
                <p style="color: var(--text-muted); margin-bottom: 1rem; font-size: 0.9rem;">Review applications and profiles</p>
                <a href="/jobseeker" class="btn btn-sm btn-success">View Job Seekers â†’</a>
              </div>
            </div>
          </div>

          <!-- Contact Messages -->
          <div class="col-md-6 col-lg-4">
            <div class="card h-100 border-0 shadow-sm" style="background: white; border-radius: 15px; transition: transform 0.3s, box-shadow 0.3s; cursor: pointer; text-align: center; margin-left: auto; margin-right: auto;">
              <div class="card-body p-4">
                <div style="font-size: 2.5rem; margin-bottom: 1rem;">ğŸ’¬</div>
                <h5 style="font-weight: 600; color: var(--info-color); margin-bottom: 0.5rem;">Contact Messages</h5>
                <p style="color: var(--text-muted); margin-bottom: 1rem; font-size: 0.9rem;">Read and respond to messages</p>
                <a href="/contact_view" class="btn btn-sm btn-info">View Messages â†’</a>
              </div>
            </div>
          </div>

          <!-- Add City -->
          <div class="col-md-6 col-lg-4">
            <div class="card h-100 border-0 shadow-sm" style="background: white; border-radius: 15px; transition: transform 0.3s, box-shadow 0.3s; cursor: pointer; text-align: center; margin-left: auto; margin-right: auto;">
              <div class="card-body p-4">
                <div style="font-size: 2.5rem; margin-bottom: 1rem;">ğŸ™ï¸</div>
                <h5 style="font-weight: 600; color: var(--primary-color); margin-bottom: 0.5rem;">Add City</h5>
                <p style="color: var(--text-muted); margin-bottom: 1rem; font-size: 0.9rem;">Manage city information</p>
                <a href="/city" class="btn btn-sm btn-primary">Manage Cities â†’</a>
              </div>
            </div>
          </div>

          <!-- Add Qualification -->
          <div class="col-md-6 col-lg-4">
            <div class="card h-100 border-0 shadow-sm" style="background: white; border-radius: 15px; transition: transform 0.3s, box-shadow 0.3s; cursor: pointer; text-align: center; margin-left: auto; margin-right: auto;">
              <div class="card-body p-4">
                <div style="font-size: 2.5rem; margin-bottom: 1rem;">ğŸ“</div>
                <h5 style="font-weight: 600; color: var(--success-color); margin-bottom: 0.5rem;">Add Qualification</h5>
                <p style="color: var(--text-muted); margin-bottom: 1rem; font-size: 0.9rem;">Add new educational qualifications</p>
                <a href="/qualification" class="btn btn-sm btn-success">Manage Qualifications â†’</a>
              </div>
            </div>
          </div>

          <!-- Change Password -->
          <div class="col-md-6 col-lg-4">
            <div class="card h-100 border-0 shadow-sm" style="background: white; border-radius: 15px; transition: transform 0.3s, box-shadow 0.3s; cursor: pointer; text-align: center; margin-left: auto; margin-right: auto;">
              <div class="card-body p-4">
                <div style="font-size: 2.5rem; margin-bottom: 1rem;">ğŸ”</div>
                <h5 style="font-weight: 600; color: var(--info-color); margin-bottom: 0.5rem;">Change Password</h5>
                <p style="color: var(--text-muted); margin-bottom: 1rem; font-size: 0.9rem;">Update your admin password</p>
                <a href="/change_password" class="btn btn-sm btn-info">Change Password â†’</a>
              </div>
            </div>
          </div>
        </div>

        <!-- System Status Table (Centered) -->
        <div class="card" style="background: white; border: none; border-radius: 15px; box-shadow: 0 10px 40px rgba(0,0,0,0.2); overflow: hidden;">
          <div class="card-body p-0">
            <div style="background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%); color: white; padding: 1.5rem; font-weight: 600; font-size: 1.1rem; text-align: center;">
              ğŸ“Š System Status
            </div>
            <table class="table table-hover mb-0">
              <tbody>
                <tr>
                  <td style="padding: 1rem; text-align: center;">ğŸ‘¥ Employee Database</td>
                  <td style="padding: 1rem; text-align: center;"><span class="badge bg-success">âœ“ Active</span></td>
                  <td style="padding: 1rem; text-align: center; color: var(--text-muted);">{{ total_employees }} records</td>
                </tr>
                <tr>
                  <td style="padding: 1rem; text-align: center;">ğŸ¯ Job Seeker Portal</td>
                  <td style="padding: 1rem; text-align: center;"><span class="badge bg-success">âœ“ Active</span></td>
                  <td style="padding: 1rem; text-align: center; color: var(--text-muted);">{{ total_jobseekers }} active</td>
                </tr>
                <tr>
                  <td style="padding: 1rem; text-align: center;">ğŸ’¬ Contact System</td>
                  <td style="padding: 1rem; text-align: center;"><span class="badge bg-success">âœ“ Active</span></td>
                  <td style="padding: 1rem; text-align: center; color: var(--text-muted);">{{ total_messages }} messages</td>
                </tr>
                <tr>
                  <td style="padding: 1rem; text-align: center;">ğŸ” Security System</td>
                  <td style="padding: 1rem; text-align: center;"><span class="badge bg-success">âœ“ Secure</span></td>
                  <td style="padding: 1rem; text-align: center; color: var(--text-muted);">All systems secured</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

      </div>
    </div>

    {% endblock body %}

    <!-- Footer -->
    <footer style="background: linear-gradient(135deg, #0c4a6e 0%, #0f766e 100%); color: white; text-align: center; padding: 1.5rem;">
      <small>Copyright Â© Digital HR | Admin Dashboard | Developed By: Avikal Singh</small>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>


    <!-- ====================================
      THE LOGOUT JAVASCRIPT FUNCTIONALITY BELOW
      ==================================== -->
    <script>
      function confirmLogout(e) {
          e.preventDefault();
          
          // Show confirmation dialog
          if (confirm('Are you sure you want to log out?')) {
              // Show loading effect before redirect
              showLogoutAnimation();
              
              // Redirect to logout view after 1 second
              setTimeout(function() {
                  window.location.href = '/admin_logout';
              }, 1000);
          }
      }

      function showLogoutAnimation() {
          // Create overlay
          const overlay = document.createElement('div');
          overlay.style.cssText = `
              position: fixed;
              top: 0;
              left: 0;
              right: 0;
              bottom: 0;
              background: rgba(0, 0, 0, 0.7);
              display: flex;
              align-items: center;
              justify-content: center;
              z-index: 9999;
          `;
          
          // Create spinner
          const spinner = document.createElement('div');
          spinner.style.cssText = `
              width: 50px;
              height: 50px;
              border: 4px solid rgba(255, 255, 255, 0.3);
              border-top-color: white;
              border-radius: 50%;
              animation: spin 1s linear infinite;
          `;
          
          overlay.appendChild(spinner);
          document.body.appendChild(overlay);
      }
    </script>

  </body>
</html>
